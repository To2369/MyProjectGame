<!--
UNIT09_LEARNING UNIT09 学習要項
SPRITE - BLENDING

<span style="color:#994433;border: 1px red solid; padding: 2px;font-size:100%;font-weight: bold;">

Optimaizations
Batching
Primitive topology
-->

# UNIT09 SPRITE - BATCHING 学習要項

---

## <span style="color:#334488;">Optimaizations</span>
#### <span style="color:#334488;">最適化</span>

プログラムの最適化、コードの最適化、またはソフトウェアの最適化とよばれるもので、一般的に、コンピュータプログラムは、より高速に実行されるように、またはより少ないメモリストレージやリソースで動作できるように、またはより少ない電力を消費するように設計したり実装したり修正したりすることを最適化と呼びます。

---

## <span style="color:#334488;">Batching</span>
#### <span style="color:#334488;">一括処理</span>

**Batching** とは一括処理という意味になります。現状、スプライト一枚を表示するために、一回の **Draw** を呼び出しています。ですが、「同じ描画設定」、「同じテクスチャ」でありながら１００回画面に表示する際に **Draw** を１００回呼び出すのは処理の無駄です。数が増え続けるといつか処理落ちが起こります。

なのでスプライトを１００回表示する際でも描画設定が同じで、テクスチャも同じであれば **Draw** の呼び出しを一回だけにして処理を軽くする実装を行います。

このように処理を一括で行う事を **Batching** と言います。

そして **スプライト** に対して **Batching** の処理を行う事を **スプライトバッチ(sprite_batch)** と呼んでいます。

---

## <span style="color:#334488;">Primitive topology</span>
#### <span style="color:#334488;">プリミティブトポロジー</span>

ポリゴンを形作る頂点をどのように結んでいくかを設定する項目を**プリミティブトポロジー**と呼びました。

@import "images/プリミティブトポロジー.png"


現在の実装だと一回の **Draw** で１枚の四角形を表示しています。つまり **Draw** 一回で２つのポリゴンを描画しています。２枚の四角形を表示するには **Draw** を２回呼び出さなければなりません。

最適化を考慮して一回の **Draw** で２枚の四角形を表示する場合、つまり **Draw** 一回の呼び出しで４つのポリゴンを描画することが出来れば、処理が軽くなります。

ですが現状 **TRIANGLESTRIP** を利用しています、

**TRIANGLESTRIP** で２つの四角形を作る場合６個の頂点を作るだけでよいのですが、２枚目の三角形を書き終わって、３枚目の三角形を書き始めようとした際に **TRIANGLESTRIP** だと、

@import "images/トライアングルストリップ.png"

頂点番号２と３がつながっているので、２枚目と３枚目の三角形がつながった形で描かれてしまい、１回の描画では離れた位置にポリゴンを描画することが出来ません。

**TRIANGLESTRIP** の利点は少ない頂点数で多くのポリゴンを表示するというものなので今回の **sprite_batch** には適していません。

今回利用するのは **TRIANGLELIST** です。 

@import "images/トライアングルリスト.png"

四角形を１つ作るには頂点数が６個必要になりますが、頂点自体が繋がっていないので、離れた位置にポリゴンを表示させることができます。

この**プリミティブトポロジー**を利用することにより、一回の **Draw** でいくつものスプライトをいろいろな場所に表示できるようになります。